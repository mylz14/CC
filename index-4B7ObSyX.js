import{r as a,j as e,V as He,R as Ye,A as Qe,C as We,X as Fs,T as Xe,D as Ze,P as ks,a as Ds,$ as Rs,b as Ke,c as Is,u as es,S as _s,d as ss,e as ts,I as Os,f as de,g as rs,h as pe,i as as,k as Ls,l as os,m as $s,L as ns,n as ls,o as Us,p as Ms,q as Vs,s as is,t as zs,v as qs,O as ds,w as Bs,x as cs,y as ms,z as us,B as hs,E as fs,F as Gs,G as Js,H as Hs,J as Ys,K as Qs,M as Ws,N as Xs,Q as xs,U as Zs,W as Ks,Y as et,Z as st,_ as tt,a0 as me,a1 as rt,a2 as at}from"./vendor-react-B-6fQwie.js";import{C as ot,D as nt,E as De,F as lt,Q as it}from"./vendor-BiuTin6o.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const m of c.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function r(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(l){if(l.ep)return;l.ep=!0;const c=r(l);fetch(l.href,c)}})();const dt=1,ct=1e6;let Te=0;function mt(){return Te=(Te+1)%Number.MAX_SAFE_INTEGER,Te.toString()}const Ae=new Map,Be=s=>{if(Ae.has(s))return;const t=setTimeout(()=>{Ae.delete(s),le({type:"REMOVE_TOAST",toastId:s})},ct);Ae.set(s,t)},ut=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,dt)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?Be(r):s.toasts.forEach(n=>{Be(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(r=>r.id!==t.toastId)}}},he=[];let fe={toasts:[]};function le(s){fe=ut(fe,s),he.forEach(t=>{t(fe)})}function ht({...s}){const t=mt(),r=l=>le({type:"UPDATE_TOAST",toast:{...l,id:t}}),n=()=>le({type:"DISMISS_TOAST",toastId:t});return le({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:l=>{l||n()}}}),{id:t,dismiss:n,update:r}}function ft(){const[s,t]=a.useState(fe);return a.useEffect(()=>(he.push(t),()=>{const r=he.indexOf(t);r>-1&&he.splice(r,1)}),[s]),{...s,toast:ht,dismiss:r=>le({type:"DISMISS_TOAST",toastId:r})}}function u(...s){return ot(nt(s))}const xt=ks,gs=a.forwardRef(({className:s,...t},r)=>e.jsx(He,{ref:r,className:u("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));gs.displayName=He.displayName;const gt=De("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ps=a.forwardRef(({className:s,variant:t,...r},n)=>e.jsx(Ye,{ref:n,className:u(gt({variant:t}),s),...r}));ps.displayName=Ye.displayName;const pt=a.forwardRef(({className:s,...t},r)=>e.jsx(Qe,{ref:r,className:u("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));pt.displayName=Qe.displayName;const js=a.forwardRef(({className:s,...t},r)=>e.jsx(We,{ref:r,className:u("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(Fs,{className:"h-4 w-4"})}));js.displayName=We.displayName;const ys=a.forwardRef(({className:s,...t},r)=>e.jsx(Xe,{ref:r,className:u("text-sm font-semibold",s),...t}));ys.displayName=Xe.displayName;const Ns=a.forwardRef(({className:s,...t},r)=>e.jsx(Ze,{ref:r,className:u("text-sm opacity-90",s),...t}));Ns.displayName=Ze.displayName;function jt(){const{toasts:s}=ft();return e.jsxs(xt,{children:[s.map(function({id:t,title:r,description:n,action:l,...c}){return e.jsxs(ps,{...c,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(ys,{children:r}),n&&e.jsx(Ns,{children:n})]}),l,e.jsx(js,{})]},t)}),e.jsx(gs,{})]})}const yt=({...s})=>{const{theme:t="system"}=Ds();return e.jsx(Rs,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},Nt=Is,wt=a.forwardRef(({className:s,sideOffset:t=4,...r},n)=>e.jsx(Ke,{ref:n,sideOffset:t,className:u("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r}));wt.displayName=Ke.displayName;const ws=()=>e.jsx("div",{className:"p-4 text-center",children:e.jsx("a",{href:"https://www.dyad.sh/",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"Made with Dyad"})}),A=s=>{es.success(s)},w=s=>{es.error(s)},vs=a.createContext(void 0),vt=({children:s})=>{const[t,r]=a.useState(()=>{if(typeof window<"u"){const c=localStorage.getItem("currentUser");return c?JSON.parse(c):null}return null});a.useEffect(()=>{typeof window<"u"&&(t?localStorage.setItem("currentUser",JSON.stringify(t)):localStorage.removeItem("currentUser"))},[t]);const n=(c,m)=>{let f=null;return m==="Pullout"?f="worker":m==="Kieffo"?f="admin":m==="Ticroix"&&(f="controller"),f?(r({name:c,role:f}),A(`Logged in as ${c} (${f})`),!0):(w("Invalid code. Please try again."),!1)},l=()=>{r(null),A("Logged out successfully.")};return e.jsx(vs.Provider,{value:{user:t,login:n,logout:l},children:s})},je=()=>{const s=a.useContext(vs);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},bt="https://sgieburnnmijvabydwgv.supabase.co",Ct="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNnaWVidXJubm1panZhYnlkd2d2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyMjEyMDcsImV4cCI6MjA3Nzc5NzIwN30.jcEJyq0hQJem5KGGcE73E0z-OyNqIo_3Id_BpfZdU9Y",N=lt(bt,Ct),ue="Pending",bs=a.createContext(void 0),St=({children:s})=>{const[t,r]=a.useState([]),[n,l]=a.useState([]),[c,m]=a.useState(0),[f,d]=a.useState([]),[y,i]=a.useState(["Processed","Unfinished","Missing"]),[x,S]=a.useState(null),j=t.filter(g=>g.status!==ue&&!g.is_archived).length;a.useEffect(()=>{(async()=>{const{data:p,error:P}=await N.from("persons").select("*");P?(console.error("Error fetching persons:",P),w("Failed to load persons.")):r(p||[]);const{data:I,error:te}=await N.from("categories").select("*");te?(console.error("Error fetching categories:",te),w("Failed to load categories.")):l(I||[]);const{data:W,error:oe}=await N.from("settings").select("*").single();if(oe&&oe.code!=="PGRST116")console.error("Error fetching settings:",oe),w("Failed to load settings.");else if(W)S(W.id),m(W.goal),d(W.custom_field_names||[]),i(W.processing_options||["Processed","Unfinished","Missing"]);else{const{data:re,error:ne}=await N.from("settings").insert({custom_field_names:[],processing_options:["Processed","Unfinished","Missing"],goal:0}).select("*").single();ne?(console.error("Error inserting default settings:",ne),w("Failed to initialize settings.")):re&&(S(re.id),m(re.goal),d(re.custom_field_names||[]),i(re.processing_options||["Processed","Unfinished","Missing"]))}})();const h=N.channel("public:persons").on("postgres_changes",{event:"*",schema:"public",table:"persons"},p=>{p.eventType==="INSERT"?r(P=>[...P,p.new]):p.eventType==="UPDATE"?r(P=>P.map(I=>I.id===p.old.id?p.new:I)):p.eventType==="DELETE"&&r(P=>P.filter(I=>I.id!==p.old.id))}).subscribe(),F=N.channel("public:categories").on("postgres_changes",{event:"*",schema:"public",table:"categories"},p=>{p.eventType==="INSERT"?l(P=>[...P,p.new]):p.eventType==="UPDATE"?l(P=>P.map(I=>I.id===p.old.id?p.new:I)):p.eventType==="DELETE"&&l(P=>P.filter(I=>I.id!==p.old.id))}).subscribe(),D=N.channel("public:settings").on("postgres_changes",{event:"*",schema:"public",table:"settings"},p=>{p.eventType==="UPDATE"&&p.new.id===x?(m(p.new.goal),d(p.new.custom_field_names||[]),i(p.new.processing_options||["Processed","Unfinished","Missing"])):p.eventType==="INSERT"&&!x&&(S(p.new.id),m(p.new.goal),d(p.new.custom_field_names||[]),i(p.new.processing_options||["Processed","Unfinished","Missing"]))}).subscribe();return()=>{N.removeChannel(h),N.removeChannel(F),N.removeChannel(D)}},[x]);const E=a.useCallback(async(g,h,F,D,p,P,I)=>{const te={surname:g,firstname:h,middlename:F,address:D,station:p,status:ue,processedby:null,customfields:P,created_at:new Date().toISOString(),category_id:I||null,is_archived:!1},{error:W}=await N.from("persons").insert(te);W?(console.error("Error adding person:",W),w("Failed to add person.")):A("Person added successfully!")},[]),G=a.useCallback(async g=>{const h=g.map(D=>({surname:D.surname,firstname:D.firstname,middlename:D.middlename,address:D.address,station:D.station,status:ue,processedby:null,customfields:D.customfields,created_at:new Date().toISOString(),category_id:D.category_id||null,is_archived:!1})),{error:F}=await N.from("persons").insert(h);F?(console.error("Error adding persons batch:",F),w("Failed to add persons batch.")):A(`${h.length} persons added successfully!`)},[]),J=a.useCallback(async(g,h,F)=>{const{error:D}=await N.from("persons").update({status:F,processedby:h,processedat:new Date().toISOString()}).eq("id",g);D?(console.error("Error processing person:",D),w("Failed to process person.")):A(`Person marked as '${F}'!`)},[]),H=a.useCallback(async g=>{const{error:h}=await N.from("persons").update({status:ue,processedby:null,processedat:null,is_archived:!1}).eq("id",g);h?(console.error("Error undoing process:",h),w("Failed to undo process.")):A("Processing undone!")},[]),Y=a.useCallback(async g=>{const{error:h}=await N.from("persons").update({is_archived:!0}).eq("id",g);h?(console.error("Error archiving person:",h),w("Failed to archive person.")):A("Person archived!")},[]),U=a.useCallback(async g=>{const{error:h}=await N.from("persons").update({is_archived:!1}).eq("id",g);h?(console.error("Error unarchiving person:",h),w("Failed to unarchive person.")):A("Person unarchived!")},[]),Q=a.useCallback(async()=>{const{error:g}=await N.from("persons").delete().neq("id","00000000-0000-0000-0000-000000000000");if(g){console.error("Error deleting all persons:",g),w("Failed to reset persons data.");return}const{error:h}=await N.from("categories").delete().neq("id","00000000-0000-0000-0000-000000000000");if(h){console.error("Error deleting all categories:",h),w("Failed to reset categories data.");return}if(x){const{error:F}=await N.from("settings").update({custom_field_names:[],processing_options:["Processed","Unfinished","Missing"],goal:0}).eq("id",x);if(F){console.error("Error resetting settings:",F),w("Failed to reset settings.");return}}A("All data reset!")},[x]),X=a.useCallback(async g=>{if(g<0){w("Goal cannot be negative.");return}if(x){const{error:h}=await N.from("settings").update({goal:g}).eq("id",x);h?(console.error("Error setting goal:",h),w("Failed to set goal.")):A(`Processing goal set to ${g}.`)}},[x]),M=a.useCallback(async g=>{if(x){const{error:h}=await N.from("settings").update({custom_field_names:g}).eq("id",x);h?(console.error("Error setting custom field names:",h),w("Failed to set custom field names.")):A("Custom field names updated!")}},[x]),Z=a.useCallback(async g=>{if(x){const{error:h}=await N.from("settings").update({processing_options:g}).eq("id",x);h?(console.error("Error setting processing options:",h),w("Failed to set processing options.")):A("Processing options updated!")}},[x]),ee=a.useCallback(async g=>{const{error:h}=await N.from("categories").insert({name:g});h?(console.error("Error adding category:",h),w("Failed to add category.")):A("Category added successfully!")},[]),se=a.useCallback(async(g,h)=>{const{error:F}=await N.from("categories").update({name:h}).eq("id",g);F?(console.error("Error updating category:",F),w("Failed to update category.")):A("Category updated successfully!")},[]),O=a.useCallback(async g=>{const{error:h}=await N.from("categories").delete().eq("id",g);h?(console.error("Error deleting category:",h),w("Failed to delete category.")):A("Category deleted successfully!")},[]);return e.jsx(bs.Provider,{value:{persons:t,categories:n,goal:c,processedCount:j,customFieldNames:f,processingOptions:y,addPerson:E,addPersonsBatch:G,processPerson:J,undoProcess:H,archivePerson:Y,unarchivePerson:U,resetAll:Q,setGoal:X,setCustomFieldNames:M,setProcessingOptions:Z,addCategory:ee,updateCategory:se,deleteCategory:O},children:s})},K=()=>{const s=a.useContext(bs);if(s===void 0)throw new Error("usePersons must be used within a PersonProvider");return s},Re=De("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),C=a.forwardRef(({className:s,variant:t,size:r,asChild:n=!1,...l},c)=>{const m=n?_s:"button";return e.jsx(m,{className:u(Re({variant:t,size:r,className:s})),ref:c,...l})});C.displayName="Button";const L=a.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:u("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));L.displayName="Card";const z=a.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:u("flex flex-col space-y-1.5 p-6",s),...t}));z.displayName="CardHeader";const $=a.forwardRef(({className:s,...t},r)=>e.jsx("h3",{ref:r,className:u("text-2xl font-semibold leading-none tracking-tight",s),...t}));$.displayName="CardTitle";const B=a.forwardRef(({className:s,...t},r)=>e.jsx("p",{ref:r,className:u("text-sm text-muted-foreground",s),...t}));B.displayName="CardDescription";const q=a.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:u("p-6 pt-0",s),...t}));q.displayName="CardContent";const Pt=a.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:u("flex items-center p-6 pt-0",s),...t}));Pt.displayName="CardFooter";const k=a.forwardRef(({className:s,type:t,...r},n)=>e.jsx("input",{type:t,className:u("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...r}));k.displayName="Input";const Tt=De("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),_=a.forwardRef(({className:s,...t},r)=>e.jsx(ss,{ref:r,className:u(Tt(),s),...t}));_.displayName=ss.displayName;const At=({percentage:s,size:t=100,strokeWidth:r=10})=>{const n=(t-r)/2,l=2*Math.PI*n,c=l-s/100*l;return e.jsxs("svg",{width:t,height:t,className:"transform -rotate-90",children:[e.jsx("circle",{stroke:"hsl(var(--muted))",fill:"transparent",strokeWidth:r,r:n,cx:t/2,cy:t/2}),e.jsx("circle",{stroke:"hsl(var(--primary))",fill:"transparent",strokeWidth:r,strokeDasharray:l+" "+l,style:{strokeDashoffset:c},r:n,cx:t/2,cy:t/2,strokeLinecap:"round",className:"transition-all duration-500 ease-in-out"}),e.jsxs("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",fill:"hsl(var(--foreground))",fontSize:"1.2em",className:"transform rotate-90 origin-center",children:[Math.round(s),"%"]})]})},Ie=a.forwardRef(({className:s,...t},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:u("w-full caption-bottom text-sm",s),...t})}));Ie.displayName="Table";const _e=a.forwardRef(({className:s,...t},r)=>e.jsx("thead",{ref:r,className:u("[&_tr]:border-b",s),...t}));_e.displayName="TableHeader";const Oe=a.forwardRef(({className:s,...t},r)=>e.jsx("tbody",{ref:r,className:u("[&_tr:last-child]:border-0",s),...t}));Oe.displayName="TableBody";const Et=a.forwardRef(({className:s,...t},r)=>e.jsx("tfoot",{ref:r,className:u("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));Et.displayName="TableFooter";const ie=a.forwardRef(({className:s,...t},r)=>e.jsx("tr",{ref:r,className:u("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));ie.displayName="TableRow";const v=a.forwardRef(({className:s,...t},r)=>e.jsx("th",{ref:r,className:u("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t}));v.displayName="TableHead";const b=a.forwardRef(({className:s,...t},r)=>e.jsx("td",{ref:r,className:u("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t}));b.displayName="TableCell";const Ft=a.forwardRef(({className:s,...t},r)=>e.jsx("caption",{ref:r,className:u("mt-4 text-sm text-muted-foreground",s),...t}));Ft.displayName="TableCaption";const Fe=zs,ke=qs,xe=a.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(ts,{ref:n,className:u("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...r,children:[t,e.jsx(Os,{asChild:!0,children:e.jsx(de,{className:"h-4 w-4 opacity-50"})})]}));xe.displayName=ts.displayName;const Cs=a.forwardRef(({className:s,...t},r)=>e.jsx(rs,{ref:r,className:u("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(pe,{className:"h-4 w-4"})}));Cs.displayName=rs.displayName;const Ss=a.forwardRef(({className:s,...t},r)=>e.jsx(as,{ref:r,className:u("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(de,{className:"h-4 w-4"})}));Ss.displayName=as.displayName;const ge=a.forwardRef(({className:s,children:t,position:r="popper",...n},l)=>e.jsx(Ls,{children:e.jsxs(os,{ref:l,className:u("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...n,children:[e.jsx(Cs,{}),e.jsx($s,{className:u("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Ss,{})]})}));ge.displayName=os.displayName;const kt=a.forwardRef(({className:s,...t},r)=>e.jsx(ns,{ref:r,className:u("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));kt.displayName=ns.displayName;const ae=a.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(ls,{ref:n,className:u("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Us,{children:e.jsx(Ms,{className:"h-4 w-4"})})}),e.jsx(Vs,{children:t})]}));ae.displayName=ls.displayName;const Dt=a.forwardRef(({className:s,...t},r)=>e.jsx(is,{ref:r,className:u("-mx-1 my-1 h-px bg-muted",s),...t}));Dt.displayName=is.displayName;const Rt=()=>{const{addPersonsBatch:s,customFieldNames:t,categories:r}=K(),[n,l]=a.useState("none"),c=m=>{var y;const f=(y=m.target.files)==null?void 0:y[0];if(!f)return;if(f.type!=="text/csv"){w("Please upload a CSV file.");return}const d=new FileReader;d.onload=i=>{var S;const x=(S=i.target)==null?void 0:S.result;try{const j=x.split(`
`).filter(H=>H.trim()!=="");if(j.length===0)throw new Error("CSV file is empty.");const E=j.slice(1);if(E.length===0)throw new Error("CSV file has only headers.");const G=5,J=E.map((H,Y)=>{const U=H.split(",").map(O=>O.trim());if(U.length<G)throw new Error(`Invalid data on line ${Y+2}. Must include surname, firstname, middlename, address, station.`);const[Q,X,M,Z,ee]=U,se={};for(let O=0;O<t.length;O++)U[G+O]!==void 0&&(se[t[O]]=U[G+O]);return{surname:Q,firstname:X,middlename:M,address:Z,station:ee,customfields:se,category_id:n==="none"?null:n}});s(J),m.target.value=""}catch(j){w(`Error parsing CSV: ${j.message}`),m.target.value=""}},d.readAsText(f)};return e.jsxs(L,{className:"w-full",children:[e.jsxs(z,{children:[e.jsx($,{children:"Upload Persons from CSV"}),e.jsx(B,{children:"Upload a CSV file. The first row should be headers (e.g., 'surname,firstname,middlename,address,station,...customFieldNames') and will be skipped."})]}),e.jsxs(q,{children:[e.jsxs("div",{className:"grid w-full items-center gap-1.5 mb-4",children:[e.jsx(_,{htmlFor:"csv-category",children:"Category (Optional)"}),e.jsxs(Fe,{onValueChange:l,value:n,children:[e.jsx(xe,{id:"csv-category",children:e.jsx(ke,{placeholder:"Select a category"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"none",children:"None"}),r.map(m=>e.jsx(ae,{value:m.id,children:m.name},m.id))]})]})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(_,{htmlFor:"csv-upload",children:"CSV File"}),e.jsx(k,{id:"csv-upload",type:"file",accept:".csv",onChange:c})]})]})]})},Le=Gs,$e=Js,It=Bs,Ps=a.forwardRef(({className:s,...t},r)=>e.jsx(ds,{className:u("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:r}));Ps.displayName=ds.displayName;const ye=a.forwardRef(({className:s,...t},r)=>e.jsxs(It,{children:[e.jsx(Ps,{}),e.jsx(cs,{ref:r,className:u("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t})]}));ye.displayName=cs.displayName;const Ne=({className:s,...t})=>e.jsx("div",{className:u("flex flex-col space-y-2 text-center sm:text-left",s),...t});Ne.displayName="AlertDialogHeader";const we=({className:s,...t})=>e.jsx("div",{className:u("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});we.displayName="AlertDialogFooter";const ve=a.forwardRef(({className:s,...t},r)=>e.jsx(ms,{ref:r,className:u("text-lg font-semibold",s),...t}));ve.displayName=ms.displayName;const be=a.forwardRef(({className:s,...t},r)=>e.jsx(us,{ref:r,className:u("text-sm text-muted-foreground",s),...t}));be.displayName=us.displayName;const Ce=a.forwardRef(({className:s,...t},r)=>e.jsx(hs,{ref:r,className:u(Re(),s),...t}));Ce.displayName=hs.displayName;const Se=a.forwardRef(({className:s,...t},r)=>e.jsx(fs,{ref:r,className:u(Re({variant:"outline"}),"mt-2 sm:mt-0",s),...t}));Se.displayName=fs.displayName;const Ue=Hs,Me=Ys,Ve=Qs,_t=({isCategoriesOpen:s,setIsCategoriesOpen:t})=>{const{categories:r,addCategory:n,updateCategory:l,deleteCategory:c}=K(),[m,f]=a.useState(""),[d,y]=a.useState(null),i=async j=>{j.preventDefault(),m.trim()&&(await n(m.trim()),f(""))},x=async(j,E)=>{E.trim()&&E.trim()!==(d==null?void 0:d.name)&&(await l(j,E.trim()),y(null))},S=async j=>{await c(j)};return e.jsx(Ue,{open:s,onOpenChange:t,className:"w-full max-w-4xl mb-6 space-y-2",children:e.jsxs(L,{className:"w-full",children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsx($,{children:"Manage Categories"}),e.jsx(Me,{asChild:!0,children:e.jsxs(C,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[s?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle categories"})]})})]}),e.jsxs(Ve,{children:[e.jsx(B,{className:"px-6 pb-4",children:"Create, edit, or delete categories for organizing persons."}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("form",{onSubmit:i,className:"flex gap-2",children:[e.jsx(k,{type:"text",placeholder:"New Category Name",value:m,onChange:j=>f(j.target.value),required:!0,className:"flex-grow"}),e.jsx(C,{type:"submit",children:"Add Category"})]}),r.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No categories defined yet."}):e.jsx("ul",{className:"space-y-2",children:r.map(j=>e.jsx("li",{className:"flex items-center justify-between p-2 border rounded-md",children:(d==null?void 0:d.id)===j.id?e.jsxs("form",{onSubmit:E=>{E.preventDefault(),x(j.id,d.name)},className:"flex-grow flex gap-2",children:[e.jsx(k,{value:d.name,onChange:E=>y({...d,name:E.target.value}),required:!0}),e.jsx(C,{type:"submit",size:"sm",children:"Save"}),e.jsx(C,{type:"button",variant:"outline",size:"sm",onClick:()=>y(null),children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium",children:j.name}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(C,{variant:"ghost",size:"sm",onClick:()=>y(j),children:[e.jsx(Ws,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Edit"})]}),e.jsxs(Le,{children:[e.jsx($e,{asChild:!0,children:e.jsxs(C,{variant:"ghost",size:"sm",children:[e.jsx(Xs,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"sr-only",children:"Delete"})]})}),e.jsxs(ye,{children:[e.jsxs(Ne,{children:[e.jsxs(ve,{children:['Are you sure you want to delete "',j.name,'"?']}),e.jsx(be,{children:'This action cannot be undone. All persons currently assigned to this category will have their category set to "None".'})]}),e.jsxs(we,{children:[e.jsx(Se,{children:"Cancel"}),e.jsx(Ce,{onClick:()=>S(j.id),children:"Delete"})]})]})]})]})]})},j.id))})]})]})]})})},Ot=({isCustomFieldsOpen:s,setIsCustomFieldsOpen:t})=>{const{customFieldNames:r,setCustomFieldNames:n}=K(),[l,c]=a.useState(r);a.useEffect(()=>{c(r)},[r]);const m=(d,y)=>{const i=[...l];i[d]=y,c(i)},f=()=>{const d=l.filter(y=>y.trim()!=="");n(d),A("Custom field names updated!")};return e.jsx(Ue,{open:s,onOpenChange:t,className:"w-full max-w-4xl mb-6 space-y-2",children:e.jsxs(L,{className:"w-full",children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsx($,{children:"Define Custom Fields"}),e.jsx(Me,{asChild:!0,children:e.jsxs(C,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[s?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle custom fields"})]})})]}),e.jsxs(Ve,{children:[e.jsx(B,{className:"px-6 pb-4",children:"Add up to 3 custom headings for person data (e.g., Sex, Age, Race)."}),e.jsxs(q,{className:"space-y-4",children:[[0,1,2].map(d=>e.jsxs("div",{children:[e.jsxs(_,{htmlFor:`custom-field-${d}`,children:["Custom Field ",d+1]}),e.jsx(k,{id:`custom-field-${d}`,value:l[d]||"",onChange:y=>m(d,y.target.value),placeholder:`e.g., ${d===0?"Sex":d===1?"Age":"Race"}`})]},d)),e.jsx(C,{onClick:f,className:"w-full",children:"Save Custom Field Names"})]})]})]})})},Lt=({isProcessingOptionsOpen:s,setIsProcessingOptionsOpen:t})=>{const{processingOptions:r,setProcessingOptions:n}=K(),[l,c]=a.useState(r);a.useEffect(()=>{c(r)},[r]);const m=(d,y)=>{const i=[...l];i[d]=y,c(i)},f=()=>{const d=l.filter(y=>y.trim()!=="");n(d),A("Processing options updated!")};return e.jsx(Ue,{open:s,onOpenChange:t,className:"w-full max-w-4xl mb-6 space-y-2",children:e.jsxs(L,{className:"w-full",children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsx($,{children:"Define Processing Options"}),e.jsx(Me,{asChild:!0,children:e.jsxs(C,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[s?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle processing options"})]})})]}),e.jsxs(Ve,{children:[e.jsx(B,{className:"px-6 pb-4",children:"Add up to 3 custom options for processing status (e.g., Processed, Unfinished, Missing)."}),e.jsxs(q,{className:"space-y-4",children:[[0,1,2].map(d=>e.jsxs("div",{children:[e.jsxs(_,{htmlFor:`processing-option-${d}`,children:["Option ",d+1]}),e.jsx(k,{id:`processing-option-${d}`,value:l[d]||"",onChange:y=>m(d,y.target.value),placeholder:`e.g., ${d===0?"Processed":d===1?"Unfinished":"Missing"}`})]},d)),e.jsx(C,{onClick:f,className:"w-full",children:"Save Processing Options"})]})]})]})})},$t=()=>{const{goal:s,setGoal:t,resetAll:r}=K(),[n,l]=a.useState(s.toString()),c=m=>{m.preventDefault();const f=parseInt(n,10);isNaN(f)?w("Please enter a valid number for the goal."):t(f)};return e.jsxs("div",{className:"w-full md:w-1/2 space-y-4",children:[e.jsxs(L,{className:"p-4",children:[e.jsx($,{className:"text-xl mb-2",children:"Set Processing Goal"}),e.jsxs("form",{onSubmit:c,className:"flex gap-2",children:[e.jsx(k,{type:"number",placeholder:"Set Goal",value:n,onChange:m=>l(m.target.value),min:"0",className:"flex-grow"}),e.jsx(C,{type:"submit",children:"Set Goal"})]})]}),e.jsxs(L,{className:"p-4",children:[e.jsx($,{className:"text-xl mb-2",children:"Reset Application Data"}),e.jsx(B,{className:"mb-2",children:"This will clear all persons, custom fields, and reset the goal."}),e.jsx(C,{onClick:r,variant:"destructive",className:"w-full",children:"Reset All Data"})]})]})},Ee="Pending",Ut=()=>{const{user:s,logout:t}=je(),{persons:r,categories:n,addPerson:l,goal:c,processedCount:m,customFieldNames:f,processingOptions:d,processPerson:y}=K(),[i,x]=a.useState(""),[S,j]=a.useState(""),[E,G]=a.useState(""),[J,H]=a.useState(""),[Y,U]=a.useState(""),[Q,X]=a.useState({}),[M,Z]=a.useState(null),[ee,se]=a.useState(""),[O,g]=a.useState(d.length>0?d[0]:"Processed"),[h,F]=a.useState(!1),[D,p]=a.useState(!1),[P,I]=a.useState(!1);a.useEffect(()=>{n.length>0&&!M?Z(n[0].id):n.length===0&&M!==null&&Z(null)},[n,M]);const te=o=>{o.preventDefault(),i&&S&&J&&Y&&(l(i,S,E,J,Y,Q,M),x(""),j(""),G(""),H(""),U(""),X({}))},W=()=>{const T=`data:text/csv;charset=utf-8,${["surname","firstname","middlename","address","station",...f].join(",")}
`,R=encodeURI(T),V=document.createElement("a");V.setAttribute("href",R),V.setAttribute("download","persons_template.csv"),document.body.appendChild(V),V.click(),document.body.removeChild(V),A("CSV template downloaded!")},oe=o=>{s!=null&&s.name&&O&&y(o,s.name,O)},ne=r.filter(o=>o.status===Ee).filter(o=>{const T=ee.toLowerCase(),R=`${o.firstname} ${o.surname}`.toLowerCase(),V=`${o.surname} ${o.firstname}`.toLowerCase(),Ts=o.surname.toLowerCase().includes(T)||o.firstname.toLowerCase().includes(T)||o.middlename&&o.middlename.toLowerCase().includes(T)||o.address.toLowerCase().includes(T)||o.station.toLowerCase().includes(T)||R.includes(T)||V.includes(T),As=f.some(Es=>{var ze,qe;return(qe=(ze=o.customfields)==null?void 0:ze[Es])==null?void 0:qe.toLowerCase().includes(T)});return Ts||As});let Pe=0,ce="";return d.length===1?(Pe=c>0?m/c*100:0,ce=`Processed: ${m} / ${c}`):r.length>0?(Pe=m/r.length*100,ce=`Processed: ${m} / ${r.length}`):ce="No persons added",e.jsxs("div",{className:"min-h-screen flex flex-col items-center bg-gray-100 dark:bg-gray-900 p-4",children:[e.jsxs(L,{className:"w-full max-w-4xl mb-6",children:[e.jsxs(z,{className:"flex flex-row items-center justify-between",children:[e.jsxs($,{className:"text-3xl font-bold",children:["Welcome, ",s==null?void 0:s.name,"!"]}),e.jsx(C,{onClick:t,variant:"outline",children:"Logout"})]}),e.jsxs(q,{children:[e.jsxs("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-4",children:["You are logged in as a"," ",e.jsx("span",{className:"font-semibold capitalize",children:s==null?void 0:s.role}),"."]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-around gap-6 mt-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(At,{percentage:Pe,size:150,strokeWidth:15}),e.jsx("p",{className:"mt-2 text-lg font-medium",children:ce}),d.length>1&&m>0&&e.jsxs("div",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Breakdown:"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:d.filter(o=>o!==Ee).map(o=>{const T=r.filter(V=>V.status===o).length,R=m>0?T/m*100:0;return e.jsxs("li",{children:[o,": ",T," (",Math.round(R),"%)"]},o)})})]})]}),(s==null?void 0:s.role)==="controller"&&e.jsx($t,{})]})]})]}),(s==null?void 0:s.role)==="controller"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full max-w-4xl mb-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(L,{className:"w-full",children:[e.jsxs(z,{children:[e.jsx($,{children:"Upload New Person"}),e.jsx(B,{children:"Enter details for a new person to be processed."})]}),e.jsx(q,{children:e.jsxs("form",{onSubmit:te,className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"surname",children:"Surname"}),e.jsx(k,{id:"surname",value:i,onChange:o=>x(o.target.value),placeholder:"Person Surname",required:!0,autoComplete:"family-name"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"firstname",children:"First Name"}),e.jsx(k,{id:"firstname",value:S,onChange:o=>j(o.target.value),placeholder:"Person First Name",required:!0,autoComplete:"given-name"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"middlename",children:"Middle Name (Optional)"}),e.jsx(k,{id:"middlename",value:E,onChange:o=>G(o.target.value),placeholder:"Middle Name",autoComplete:"additional-name"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"address",children:"Address"}),e.jsx(k,{id:"address",value:J,onChange:o=>H(o.target.value),placeholder:"Person Address",required:!0,autoComplete:"street-address"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"station",children:"Station"}),e.jsx(k,{id:"station",value:Y,onChange:o=>U(o.target.value),placeholder:"Station Name",required:!0,autoComplete:"organization"})]}),f.map(o=>e.jsxs("div",{children:[e.jsx(_,{htmlFor:`custom-${o}`,children:o}),e.jsx(k,{id:`custom-${o}`,value:Q[o]||"",onChange:T=>X(R=>({...R,[o]:T.target.value})),placeholder:o})]},o)),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"category",children:"Category (Optional)"}),e.jsxs(Fe,{onValueChange:o=>Z(o==="none"?null:o),value:M||"none",children:[e.jsx(xe,{id:"category",children:e.jsx(ke,{placeholder:"Select a category"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"none",children:"None"}),n.map(o=>e.jsx(ae,{value:o.id,children:o.name},o.id))]})]})]}),e.jsx("div",{children:e.jsx(C,{type:"submit",className:"w-full",children:"Add Person"})})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Rt,{}),e.jsxs(L,{className:"w-full",children:[e.jsxs(z,{children:[e.jsx($,{children:"CSV Template"}),e.jsx(B,{children:"Download a CSV template with current headers."})]}),e.jsx(q,{children:e.jsx(C,{onClick:W,className:"w-full",children:"Download CSV Template"})})]})]})]}),e.jsx(_t,{isCategoriesOpen:P,setIsCategoriesOpen:I}),e.jsx(Ot,{isCustomFieldsOpen:h,setIsCustomFieldsOpen:F}),e.jsx(Lt,{isProcessingOptionsOpen:D,setIsProcessingOptionsOpen:p})]}),e.jsxs(L,{className:"w-full max-w-4xl",children:[e.jsxs(z,{children:[e.jsx($,{children:"Pending Persons"}),e.jsx(B,{children:"List of persons awaiting processing."})]}),e.jsxs(q,{children:[e.jsx("div",{className:"flex justify-center gap-4 mb-6",children:e.jsx(xs,{to:"/processed",children:e.jsx(C,{variant:"outline",children:"View Processed Persons"})})}),e.jsx("div",{className:"mb-4",children:e.jsx(k,{type:"text",placeholder:"Search by name, address, station, or custom fields...",value:ee,onChange:o=>se(o.target.value),className:"w-full"})}),ne.length===0?e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"No pending persons found matching your criteria."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ie,{children:[e.jsx(_e,{children:e.jsxs(ie,{children:[e.jsx(v,{children:"Surname"}),e.jsx(v,{children:"First Name"}),e.jsx(v,{children:"Middle Name"}),e.jsx(v,{children:"Address"}),e.jsx(v,{children:"Station"}),e.jsx(v,{children:"Category"}),f.map(o=>e.jsx(v,{children:o},o)),e.jsx(v,{children:"Status"})]})}),e.jsx(Oe,{children:ne.map(o=>{var T;return e.jsxs(Le,{children:[e.jsx($e,{asChild:!0,children:e.jsxs(ie,{className:(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="controller"?"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800":"",children:[e.jsx(b,{className:"font-medium",children:o.surname}),e.jsx(b,{children:o.firstname}),e.jsx(b,{children:o.middlename||"N/A"}),e.jsx(b,{children:o.address}),e.jsx(b,{children:o.station}),e.jsx(b,{children:((T=n.find(R=>R.id===o.category_id))==null?void 0:T.name)||"N/A"}),f.map(R=>{var V;return e.jsx(b,{children:((V=o.customfields)==null?void 0:V[R])||"N/A"},`${o.id}-${R}`)}),e.jsx(b,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${o.status===Ee?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}`,children:o.status})})]})}),((s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="controller")&&e.jsxs(ye,{children:[e.jsxs(Ne,{children:[e.jsxs(ve,{children:["Process ",o.firstname," ",o.surname,"?"]}),e.jsx(be,{children:'Select a status for this person. This will move them to the "Processed Persons" page.'})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(_,{htmlFor:"status-select",className:"text-right",children:"Status"}),e.jsxs(Fe,{onValueChange:g,value:O,children:[e.jsx(xe,{className:"col-span-3",children:e.jsx(ke,{placeholder:"Select a status"})}),e.jsx(ge,{children:d.map(R=>e.jsx(ae,{value:R,children:R},R))})]})]})}),e.jsxs(we,{children:[e.jsx(Se,{children:"Cancel"}),e.jsx(Ce,{onClick:()=>oe(o.id),children:"Confirm"})]})]})]},o.id)})})]})})]})]}),e.jsx(ws,{})]})},Mt=()=>{const s=Zs();return a.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",s.pathname)},[s.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},Vt=()=>{const[s,t]=a.useState(""),[r,n]=a.useState(""),{login:l}=je(),c=Ks(),m=f=>{f.preventDefault(),l(s,r)&&c("/")};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900",children:e.jsxs(L,{className:"w-full max-w-md",children:[e.jsxs(z,{className:"text-center",children:[e.jsx($,{className:"text-2xl",children:"Login"}),e.jsx(B,{children:"Enter your name and role code to access the application."})]}),e.jsx(q,{children:e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"name",children:"Name"}),e.jsx(k,{id:"name",type:"text",placeholder:"Your Name",value:s,onChange:f=>t(f.target.value),required:!0,autoComplete:"name"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"code",children:"Role Code"}),e.jsx(k,{id:"code",type:"password",placeholder:"worker, admin, or controller",value:r,onChange:f=>n(f.target.value),required:!0,autoComplete:"current-password"})]}),e.jsx(C,{type:"submit",className:"w-full",children:"Login"})]})})]})})},Ge="Pending",zt=()=>{const{user:s}=je(),{persons:t,undoProcess:r,customFieldNames:n,categories:l}=K(),[c,m]=a.useState(""),f=i=>{r(i)},y=t.filter(i=>i.status!==Ge).filter(i=>{var Y,U;const x=c.toLowerCase(),S=`${i.firstname} ${i.surname}`.toLowerCase(),j=`${i.surname} ${i.firstname}`.toLowerCase(),E=i.surname.toLowerCase().includes(x)||i.firstname.toLowerCase().includes(x)||i.middlename&&i.middlename.toLowerCase().includes(x)||i.address.toLowerCase().includes(x)||i.station.toLowerCase().includes(x)||S.includes(x)||j.includes(x),G=n.some(Q=>{var X,M;return(M=(X=i.customfields)==null?void 0:X[Q])==null?void 0:M.toLowerCase().includes(x)}),J=(U=(Y=l.find(Q=>Q.id===i.category_id))==null?void 0:Y.name)==null?void 0:U.toLowerCase(),H=J&&J.includes(x);return E||G||H});return e.jsxs("div",{className:"min-h-screen flex flex-col items-center bg-gray-100 dark:bg-gray-900 p-4",children:[e.jsxs(L,{className:"w-full max-w-4xl mb-6",children:[e.jsxs(z,{children:[e.jsx($,{className:"text-3xl font-bold",children:"Processed Persons"}),e.jsx(B,{children:"List of all persons that have been processed."})]}),e.jsxs(q,{children:[e.jsx("div",{className:"flex justify-center gap-4 mb-6",children:e.jsx(xs,{to:"/",children:e.jsx(C,{variant:"outline",children:"View Pending Persons"})})}),e.jsx("div",{className:"mb-4",children:e.jsx(k,{type:"text",placeholder:"Search by surname, first name, middle name, address, station, category, or custom fields...",value:c,onChange:i=>m(i.target.value),className:"w-full"})}),y.length===0?e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"No processed persons found matching your criteria."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ie,{children:[e.jsx(_e,{children:e.jsxs(ie,{children:[e.jsx(v,{children:"Surname"}),e.jsx(v,{children:"First Name"}),e.jsx(v,{children:"Middle Name"}),e.jsx(v,{children:"Address"}),e.jsx(v,{children:"Station"}),e.jsx(v,{children:"Category"})," ",n.map(i=>e.jsx(v,{children:i},i)),e.jsx(v,{children:"Status"}),e.jsx(v,{children:"Processed By"}),e.jsx(v,{children:"Processed At"}),((s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="controller")&&e.jsx(v,{className:"text-right",children:"Actions"})]})}),e.jsx(Oe,{children:y.map(i=>{var x;return e.jsxs(ie,{children:[e.jsx(b,{className:"font-medium",children:i.surname}),e.jsx(b,{children:i.firstname}),e.jsx(b,{children:i.middlename||"N/A"}),e.jsx(b,{children:i.address}),e.jsx(b,{children:i.station}),e.jsx(b,{children:((x=l.find(S=>S.id===i.category_id))==null?void 0:x.name)||"N/A"})," ",n.map(S=>{var j;return e.jsx(b,{children:((j=i.customfields)==null?void 0:j[S])||"N/A"},`${i.id}-${S}`)}),e.jsx(b,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${i.status===Ge?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}`,children:i.status})}),e.jsx(b,{children:i.processedby||"N/A"}),e.jsx(b,{children:i.processedat?new Date(i.processedat).toLocaleString():"N/A"}),((s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="controller")&&e.jsx(b,{className:"text-right",children:e.jsxs(Le,{children:[e.jsx($e,{asChild:!0,children:e.jsx(C,{variant:"secondary",size:"sm",children:"Undo Process"})}),e.jsxs(ye,{children:[e.jsxs(Ne,{children:[e.jsx(ve,{children:"Are you sure you want to undo?"}),e.jsxs(be,{children:["This action will revert ",i.firstname," ",i.surname,`'s status to "Pending" and move them back to the pending list.`]})]}),e.jsxs(we,{children:[e.jsx(Se,{children:"Cancel"}),e.jsx(Ce,{onClick:()=>f(i.id),children:"Confirm Undo"})]})]})]})})]},i.id)})})]})})]})]}),e.jsx(ws,{})]})},qt=new it,Je=({children:s})=>{const{user:t}=je();return t?s:e.jsx(rt,{to:"/login",replace:!0})},Bt=()=>e.jsx(et,{client:qt,children:e.jsxs(Nt,{children:[e.jsx(jt,{}),e.jsx(yt,{}),e.jsx(st,{children:e.jsx(vt,{children:e.jsx(St,{children:e.jsxs(tt,{children:[e.jsx(me,{path:"/login",element:e.jsx(Vt,{})}),e.jsx(me,{path:"/",element:e.jsx(Je,{children:e.jsx(Ut,{})})}),e.jsx(me,{path:"/processed",element:e.jsxs(Je,{children:[e.jsx(zt,{})," "]})}),e.jsx(me,{path:"*",element:e.jsx(Mt,{})})]})})})})]})});at.createRoot(document.getElementById("root")).render(e.jsx(Bt,{}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(s=>{console.log("ServiceWorker registration successful with scope: ",s.scope)}).catch(s=>{console.warn("ServiceWorker registration failed: ",s)})});
